<form class="category-form"
    [formGroup]="categoryForm"
    (ngSubmit)="onSubmit()">
    <div *ngFor="let alert of alerts">
        <alert [type]="alert.type"
            [dismissible]="dismissible"
            (onClosed)="onClosed(alert)">{{ alert.msg }}</alert>
    </div>
    <div class="form-group category-form-field">
        <label for="name">Название:</label>
        <input class="form-control"
            type="text"
            id="name"
            placeholder="Введите название"
            formControlName="name"
            [ngClass]="{'is-invalid':  categoryForm.get('name').errors && categoryForm.get('name').touched}">
    </div>

    <div class="form-group category-form-field">
        <label for="slug">URL адрес:</label>
        <input type="text"
            class="form-control"
            id="slug"
            placeholder="Введите URL адрес"
            formControlName="slug"
            [ngClass]="{'is-invalid':  categoryForm.get('slug').errors && categoryForm.get('slug').touched}">
        <div class="invalid-feedback error"
            *ngIf="categoryForm.get('slug').errors && categoryForm.get('slug').touched">
            Введите URL адрес
        </div>
    </div>
    <div class="form-group category-form-field">
        <!-- groupBy="children" -->
        <label for="parent">Родительская категория:</label>
        <ng-select class="parent-category-select"
            [items]="categories"            
            bindLabel="name"
            bindValue="id"
            labelForId="parent"
            [multiple]="false"
            placeholder="Корень каталога"
            clearAllText="Очистить"
            formControlName="parent">
            <!-- <ng-template ng-optgroup-tmp
                let-item="item">
                {{item.name}}
            </ng-template>
            <ng-template ng-option-tmp
                let-item="item">
                {{item.name}}
            </ng-template> -->
        </ng-select>
    </div>
    <div class="form-group category-form-field">
        <label for="customFields">Дополнительные поля:</label>
        <ng-select class="parent-category-select"
            [items]="customFields"
            bindLabel="name"
            bindValue="id"
            labelForId="customFields"
            [multiple]="true"
            placeholder="Выберите поля"
            clearAllText="Очистить"
            formControlName="customFields"
            (scrollToEnd)="getCustomFieldList()">
        </ng-select>

    </div>
    <div class="form-group category-form-field">
        <label for="image">Изображение категории:</label>
        <div class="category-image-wrap">
            <div class="category-image-preview"
                *ngIf="previewUrl">
                <img [src]="previewUrl"
                    class="preview-img" />
                <button type="button"
                    (click)="removeUploadFile()"
                    class="btn v-btn-red preview-delete-btn">x</button>
            </div>
            <div class="category-image-input"
                *ngIf="!previewUrl">
                <button type="button"
                    class="btn v-btn-red add-category-btn"
                    (click)="file.value = null;file.click()"><i class="fa fa-plus"
                        aria-hidden="true"></i> Добавить
                </button>
                <input class="file"
                    #file
                    type="file"
                    accept="image/*"
                    size="28"
                    (change)="onFileChange($event)"
                    name="photo">
            </div>
        </div>
    </div>

    <div class="btn-wrap">
        <button type="submit"
            class="btn v-btn-red add-category-btn"
            [disabled]="!categoryForm.valid">
            {{buttonTitle}}
        </button>
    </div>
</form>